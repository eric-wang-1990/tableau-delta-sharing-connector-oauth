<?xml version="1.0" encoding="utf-8"?>
<pluginOAuthConfig>
    <dbclass>delta_sharing</dbclass>
    
    
    <clientIdDesktop>46e2d6e9-2803-4837-8347-439d43082e0f</clientIdDesktop>
    
    <redirectUrisDesktop>http://localhost:55555/Callback</redirectUrisDesktop>
    <redirectUrisDesktop>http://localhost:55556/Callback</redirectUrisDesktop>
    <redirectUrisDesktop>http://localhost:55557/Callback</redirectUrisDesktop>

    <authUri>https://login.microsoftonline.com/9fca8007-4338-4251-99db-4791001e3151/oauth2/v2.0/authorize</authUri>
    <tokenUri>https://login.microsoftonline.com/9fca8007-4338-4251-99db-4791001e3151/oauth2/v2.0/token</tokenUri>
    <userInfoUri>https://graph.microsoft.com/oidc/userinfo</userInfoUri>
    
    
    
    <scopes>openid</scopes>
    <scopes>email</scopes>
    <scopes>offline_access</scopes>

    <capabilities>
        <entry>
            <key>OAUTH_CAP_FIXED_PORT_IN_CALLBACK_URL</key>
            <value>true</value>
        </entry>
        <entry>
            <key>OAUTH_CAP_CLIENT_SECRET_IN_URL_QUERY_PARAM</key>
            <value>true</value>
        </entry>
        <entry>
            <key>OAUTH_CAP_PKCE_REQUIRES_CODE_CHALLENGE_METHOD</key>
            <value>true</value>
        </entry>
        <entry>
            <key>OAUTH_CAP_REQUIRE_PKCE</key>
            <value>true</value>
        </entry>

    </capabilities>
    <accessTokenResponseMaps>
        <entry>
            <key>ACCESSTOKEN</key>
            <value>access_token</value>
        </entry>
        <entry>
            <key>REFRESHTOKEN</key>
            <value>refresh_token</value>
        </entry>
        <entry>
            <key>access-token-issue-time</key>
            <value>issued_at</value>
        </entry>
        <entry>
            <key>access-token-expires-in</key>
            <value>expires_in</value>
        </entry>
        <entry>
            <key>username</key>
            <value>username</value>
        </entry>

    </accessTokenResponseMaps>
 </pluginOAuthConfig>
